<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACS Agricultural Science & Technology</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="fonts.googleapis.com" rel="stylesheet">

    <style>
        * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Roboto', sans-serif !important;
}

:root {
    --font-size-8: 0.5rem;
    --font-size-12: 0.75rem;
    --font-size-14: 0.875rem;
    --font-size-15: 0.9375rem;
    --font-size-16: 1rem;
    --font-size-24: 1.5rem;
    --font-size-32: 2rem;
    --font-size-64: 4rem;
    --main-section-bg-color: #081B33;
    --font-weight-400: 400;
    --font-weight-500: 500;
    --font-weight-600: 600;
    --font-color: #464748;
    --text-color-dark: #333333;
    --text-color-light: #5C5C5C;
    --link-color: #3361B8;
    --rounded-sm: 4px;
    --rounded-md: 8px;
    --color-primary-blue-500: #003AAD;
    --color-primary-blue-50: #E5EBF7;
    --color-yellow: #FDC82F;
    --color-yellow-hover: #FFAD00;
    --color-yellow-border: #f8c94d;
    --color-yellow-bg: rgba(255, 250, 232, 0.20);
    --spacing-sm: 0.5rem;
    --spacing-md: 1rem;
    --spacing-lg: 1.5rem;
    --spacing-xl: 2rem;
    --max-width-content: 1300px;
    --max-width-container: 1150px;
    --transition-default: 300ms ease-out;
    --shadow-dropdown: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
}

html {
    font-size: 16px;
}

p {
    overflow-wrap: break-word;
}

.column {
    float: none;
    max-width: var(--max-width-content);
    margin: 0 auto;
    padding: 0 var(--spacing-md);
}

.container {
    max-width: var(--max-width-container);
    margin: 0 auto;
    padding: var(--spacing-lg);
}

.sc-header__wrapper {
    padding: var(--spacing-md) 8rem var(--spacing-md) 7rem;
    display: flex;
    align-items: center;
    margin: 0 auto;
    background-color: #ffffff;
}

.sc-header__title {
    font-size: var(--font-size-24);
    font-weight: var(--font-weight-600);
    width: 100%;
}

.sc-custom-wrapper-header {
    width: 100%;
}

.sc-custom-wrapper-mdw {
    display: grid;
    grid-template-columns: 60% 40%;
    gap: var(--spacing-md);
    align-items: flex-start;
}

.sc-mdw {
    background: var(--main-section-bg-color);
    color: #fff;
    margin: 0 auto;
    padding: var(--spacing-lg) 8rem var(--spacing-lg) 7rem;
}

.sc-mdw__left {
    display: flex;
    flex-direction: column;
    gap: var(--font-size-24);
    min-width: 0;
    max-width: 75%;
}

.sc-mdw__blurb-value {
    font-size: var(--font-size-16);
    line-height: 1.5;
    display: inline-block;
    font-weight: var(--font-weight-400);
}

#viewEditorsMainSection {
    text-decoration: underline;
}

.sc-metrics__cites-value,
.sc-metrics__impact-value,
.sc-metrics__citescore-value {
    font-weight: var(--font-weight-400);
}

.sc-editors__line {
    margin: 0;
    font-size: var(--font-size-16);
    line-height: 1.8rem;
    cursor: pointer;
    max-width: max-content;
}

.sc-editors__link {
    color: #fff;
    font-size: var(--font-size-16);
    text-decoration: underline;
    display: inline-block;
    padding: 0;
}

.sc-cta {
    display: grid;
    gap: 16px;
    align-items: center;
    grid-template-columns: minmax(160px, 1fr) minmax(120px, 0.7fr) minmax(155px, 1fr);
    max-width: 55%;
}

.sc-cta__submit {
    background: var(--color-yellow);
    border: none;
    padding: 10px;
    border-radius: var(--rounded-sm);
    font-size: var(--font-size-16);
    cursor: pointer;
    font-weight: var(--font-weight-600);
    white-space: nowrap;
    color: var(--text-color-dark);
    transition: background-color var(--transition-default);
    height: 40px;
    text-decoration: none;
    display: flex;
    align-items: center;
    justify-content: center;
}

.sc-cta__alerts {
    background: transparent;
    border: 2px solid var(--color-yellow-border);
    color: var(--color-yellow-border);
    padding: 8px 18px;
    border-radius: var(--rounded-sm);
    cursor: pointer;
    font-size: var(--font-size-15);
    white-space: nowrap;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 40px;
    min-width: 100%;
    transition: all var(--transition-default);
}

.sc-cta__submit:hover {
    background: var(--color-yellow-hover);
}

.sc-cta__alerts:hover,
.sc-related-journals:hover {
    background: var(--color-yellow-bg);
}

.sc-cta__alert-wrap {
    display: inline-block;
    text-decoration: none;
    min-width: 100%;
}

.sc-cta__alerts img {
    margin-right: 5px;
}

.sc-reljournals {
    margin-left: 0;
    cursor: pointer;
}

.relatedElement option {
    background-color: var(--main-section-bg-color);
}

.sc-editors__eic-label,
.sc-editors__de-label,
.sc-metrics__impact-label,
.sc-metrics__cites-label,
.sc-metrics__citescore-label {
    font-weight: var(--font-weight-600);
}

.infoForAuthors {
    background-color: #ffffff;
    color: #0039A6;
    border: 1.5px solid #0039A6;
    border-radius: var(--rounded-sm);
    padding: 10px;
    font-weight: var(--font-weight-600);
    font-size: var(--font-size-16);
    transition: background-color var(--transition-default);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 40px;
}

.infoForAuthors:hover {
    background: var(--color-primary-blue-50);
}

.sc-index__list li {
    font-size: var(--font-size-16);
    font-weight: var(--font-weight-400);
    margin-top: 5px;
}

.sc-metrics-note {
    margin-top: 10px;
    font-size: var(--font-size-12);
    color: var(--text-color-light);
}

.person-info {
    flex: 1;
}

.related {
    font-size: var(--font-size-14);
    color: yellow;
}

aside {
    padding-left: 15px;
}

h5 {
    font-size: var(--fs-h3);
    gap: 10px;
    margin-bottom: 0;
}

.sc-custom-select {
    position: relative;
    width: 100%;
    height: 40px;
}

.sc-related-journals {
    cursor: pointer;
    width: 100%;
    text-align: center;
    color: var(--color-yellow-border);
    font-size: var(--font-size-16);
    text-decoration: none;
    margin-left: auto;
    white-space: nowrap;
    background-color: transparent;
    padding: 8px 10px;
    border: none;
    height: 40px;
    transition: all var(--transition-default);
    display: flex;
    align-items: center;
    justify-content: center;
}

.sc-select__menu {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 100%;
    box-shadow: var(--shadow-dropdown);
    z-index: 999;
    list-style-type: none;
    padding: 0;
    margin: 0;
    max-height: 35vh;
    overflow-y: auto;
    border-radius: var(--rounded-md);
    width: max-content;
}

.sc-select__menu li {
    color: black;
    padding: 12px 15px;
    text-decoration: none;
    display: block;
    cursor: pointer;
    transition: background-color var(--transition-default);
}

.sc-select__menu li a {
    color: var(--text-color-dark);
    text-decoration: none;
    width: 100%;
    height: 100%;
    display: inline-block;
}

.sc-select__menu li:hover {
    background-color: #e7e7e7;
}

.sc-custom-select.active .sc-select__menu {
    display: block;
}

.sc-select__arrow {
    margin-left: 4px;
}

.arrow_img {
    color: white;
}

.sc-cta__submit-wrap {
    min-width: max-content;
}

.sc-footer {
    padding: var(--spacing-md) 8rem var(--spacing-md) 7rem;
}

.sc-foot-title {
    font-weight: var(--font-weight-600);
    font-size: var(--font-size-24);
    color: var(--font-color);
}

.editor-name {
    font-weight: var(--font-weight-600);
}

.editor-name a {
    color: var(--link-color);
    font-weight: var(--font-weight-600);
    font-size: var(--font-size-16);
    font-weight: var(--font-weight-600);
}

.role-container {
    margin-top: 40px;
}

.editor-institution,
.editor-country,
.editor-email {
    font-weight: var(--font-weight-500);
    font-size: var(--font-size-16);
}

.editor-email a {
    color: var(--link-color);
}

#masthead-display {
    color: var(--text-color-dark);
}

.sc-foot-subtitle-link {
    margin-top: 8px;
    display: inline-block;
}

.sc-foot-subtitle {
    font-weight: var(--font-weight-400);
    font-size: var(--font-size-16);
    text-decoration: underline;
    color: var(--link-color);
}

.sc-editor__people {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-md);
}

.sc-editor__person,
.editor-information-container {
    display: flex;
    column-gap: 16px;
    margin: 14px 14px 14px 0;
    align-items: center;
}

.editor-info-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 24px;
    margin-top: 20px;
}

#currentIssueContainer{
    display: none;
}

.sc-editor__avatar,
.sc-editor__person img {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    flex-shrink: 0;
}

.sc-editor__details,
.editor-info {
    display: grid;
    row-gap: 4px;
}

.sc-editor__affil,
.sc-editor__country {
    font-size: var(--font-size-16);
    font-weight: var(--font-weight-500);
    color: var(--text-color-dark);
}

.sc-editor__email {
    font-size: var(--font-size-16);
    font-weight: var(--font-weight-500);
    color: var(--color-primary-blue-500);
    text-decoration: underline;
}

.sc-email-container {
    display: flex;
    align-items: center;
    gap: 2px;
}

@media (max-width: 480px) {
    .column {
        padding: 0 var(--spacing-md);
    }
}

@media (min-width: 551px) and (max-width: 767px) {
    .sc-header__wrapper {
        padding: var(--spacing-md) 4rem var(--spacing-md) var(--spacing-xl);
    }

    .sc-mdw {
        padding: var(--spacing-lg) var(--spacing-md) var(--spacing-lg) var(--spacing-xl);
    }

    .sc-reljournals {
        margin-left: 0;
        grid-column: span 10;
    }

    .sc-cta {
        grid-template-columns: 1fr 1fr;
        row-gap: 10px;
        column-gap: 4px;
        max-width: 100%;
    }

    .sc-cta__alert-wrap {
        margin-left: 10px;
    }

    .sc-related-journals {
        text-align: left !important;
        padding-left: 0 !important;
    }

    .editor-info-container {
        grid-template-columns: repeat(2, 1fr);
    }

    .sc-select__value{
        width: 100%;
    }

    .sc-footer{
        padding: var(--spacing-lg) var(--spacing-md) var(--spacing-lg) var(--spacing-xl);
    }
}

@media (max-width: 550px) {
    .sc-custom-wrapper-mdw {
        grid-template-columns: 1fr;
    }

    .sc-header__wrapper {
        padding: var(--spacing-md) 4rem var(--spacing-md) var(--spacing-xl);
    }

    .sc-mdw {
        padding: var(--spacing-md) var(--spacing-lg) var(--spacing-lg) var(--spacing-xl);
    }

    .sc-reljournals {
        margin-left: 0;
        margin-top: 6px;
        text-align: center;
    }

    .sc-related-journals {
        width: 100%;
        text-align: center;
    }

    .sc-cta {
        grid-template-columns: 1fr;
        max-width: 100%;
    }

    .sc-cta__submit,
    .sc-cta__alerts {
        width: 100%;
        margin-left: 0;
    }

    .sc-cta__alert-wrap {
        margin-left: 0;
        margin-top: 6px;
        max-width: 100%;
    }

    .sc-mdw__right {
        margin-top: 10px;
    }

    .sc-editor__people {
        grid-template-columns: 1fr;
    }

    .editor-info-container {
        grid-template-columns: 1fr;
    }

    .sc-footer{
        padding: var(--spacing-md) var(--spacing-lg) var(--spacing-lg) var(--spacing-xl);
    }

    .sc-mdw__left{
        max-width: 100%;
    }
}

@media (max-width: 375px) {

    .sc-header__wrapper,
    .sc-mdw,
    .sc-footer {
        padding-left: var(--spacing-md);
        padding-right: var(--spacing-md);
    }

    .container {
        padding: var(--spacing-md);
    }
}
    </style>
</head>

<body>
    <main>
        <section id="custom-page-silverchair" class="custom-page-silverchair">
            <div class="sc-header sc-header__wrapper" id="sc-header-wrapper" aria-labelledby="sc-header-title">
                <div class="sc-custom-wrapper-header column">
                    <h1 class="sc-header__title" id="sc-header__title" aria-live="polite"></h1>
                </div>
            </div>

            <section class="sc-mdw" id="sc-mdw" aria-label="Article metadata">
                <div class="sc-custom-wrapper-mdw column">
                    <div class="sc-mdw__left" id="sc-mdw__left" aria-label="Metadata details">
                        <section class="sc-mdw__blurb" id="sc-mdw__blurb" aria-label="Journal blurb">
                            <p class="sc-mdw__blurb-value" id="sc-mdw__blurb-value" aria-live="polite"></p>
                        </section>
                        <section class="sc-editors" id="sc-editors" aria-label="Editorial board">

                            <p class="sc-editors__line">
                                <span class="sc-editors__eic-label" id="sc-editors__eic-label">
                                    Editor-in-Chief:
                                </span>
                                <span class="sc-editors__eic-value" id="sc-editors__eic-value"
                                    aria-labelledby="sc-editors__eic-label" aria-live="polite">
                                </span>
                            </p>
                            <p class="sc-editors__line">
                                <span class="sc-editors__de-label" id="sc-editors__de-label">
                                    Deputy Editor:
                                </span>
                                <span class="sc-editors__de-value" id="sc-editors__de-value"
                                    aria-labelledby="sc-editors__de-label" aria-live="polite">
                                </span>
                            </p>
                            <p class="sc-editors__line">
                                <a class="sc-editors__link" id="sc-editors__link" tabindex="0"
                                    aria-label="View Editors & Editorial Board">
                                    View Editors &amp; Editorial Board
                                </a>
                            </p>
                        </section>

                        <section class="sc-metrics" id="sc-metrics" aria-label="Journal metrics">
                            <p class="sc-editors__line sc-metrics__line">
                                <strong class="sc-metrics__impact-label" id="sc-metrics__impact-label">
                                    2 Year Impact Factor:
                                </strong>


                                <span class="sc-metrics__impact-value" id="sc-metrics__impact-value"
                                    aria-labelledby="sc-metrics__impact-label" aria-live="polite">
                                </span>
                                &nbsp;&nbsp;&nbsp;

                                <strong class="sc-metrics__cites-label" id="sc-metrics__cites-label">
                                    Citations:
                                </strong>
                                <span class="sc-metrics__cites-value" id="sc-metrics__cites-value"
                                    aria-labelledby="sc-metrics__cites-label" aria-live="polite">
                                </span>
                                &nbsp;&nbsp;&nbsp;
                                <strong class="sc-metrics__citescore-label" id="sc-metrics__citescore-label">
                                    CiteScore:
                                </strong>
                                <span class="sc-metrics__citescore-value" id="sc-metrics__citescore-value"
                                    aria-labelledby="sc-metrics__citescore-label" aria-live="polite">
                                </span>
                            </p>

                            <p class="sc-metrics__line sc-editors__line">
                                <a href="/journal-metrics" class="sc-editors__link">
                                    View All
                                    <span class="sc-metrics__year" aria-live="polite"></span>
                                    Journal Metrics
                                </a>
                            </p>
                        </section>

                        <div class="sc-cta" aria-label="Actions">
                            <a class="sc-cta__submit-wrap" href="https://publish.acs.org/" target="_blank"
                                rel="noopener">
                                <button class="sc-cta__submit" type="button" aria-label="Submit manuscript">
                                    Submit Manuscript
                                </button>
                            </a>

                            <a rel="noopener" class="sc-cta__alert-wrap" href="https://preferences.acs.org/"
                                target="_blank">
                                <button class="sc-cta__alerts" type="button" aria-label="Get alerts">
                                    <icon class="icon-alert-bell"></icon>
                                    Get Alerts
                                </button>
                            </a>

                            <div id="sc-reljournals" class="sc-reljournals" aria-label="Related journals">
                                <div class="sc-custom-select" id="sc-custom-select" aria-expanded="false"
                                    aria-haspopup="listbox" aria-controls="sc-select__menu"
                                    aria-label="Related journals dropdown">
                                    <button name="sc-related-journals" id="sc-related-journals"
                                        class="sc-related-journals sc-select__toggle" aria-haspopup="listbox"
                                        aria-expanded="false" aria-controls="sc-select__menu"
                                        aria-label="Toggle related journals" aria-describedby="sc-select-value"
                                        type="button">
                                        <span class="sc-select__value" id="sc-select-value">
                                            Related Journals
                                        </span>
                                        <span id="sc-select__arrow" class="sc-select__arrow" aria-hidden="true">
                                            <!-- <img id="arrow_img" src="./assets/DownArrow.svg" alt="Arrow"
                                                class="sc-select__arrow-img" /> -->
                                            <span class="sc-select__arrow-img-wrapper">
                                                <icon class="sc-select__arrow-img" id="sc-select__arrow-img"></icon>
                                            </span>
                                        </span>
                                    </button>
                                    <ul onclick="relatedJournalValueUpdate(event)" id="sc-select__menu"
                                        class="sc-select__menu" aria-label="Related journals" tabindex="-1">
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- <div class="sc-mdw__right">
                        <section id="silverchair-widget-latest-issue-info">
                            <h2>Silverchair Widget</h2>
                            <p>Goes here</p>
                        </section>
                    </div> -->
                </div>
            </section>

            <section class="sc-footer" id="sc-footer">
                <div class="column sc-footer-custom-wrapper">
                    <div id="currentIssueContainer" class="sc-footer-title-wrap">
                        <h2 class="sc-foot-title">Editors & Editorial Board</h2>
                        <a href="" class="sc-foot-subtitle-link">
                            <h5 class="sc-foot-subtitle">View the Masthead in Current Issue</h5>
                        </a>
                    </div>

                    <div class="" id="masthead-display"></div>
                </div>
            </section>
        </section>
    </main>
    <script>
        let JSON_DIR;
let ASSETS_DIR;
let route = "aamick";
let jpcFilter = "";
let environment = "local";
let dataJPC;
if (route === "jpcafh" || route === "jpcbfk" || route === "jpccck") {
  jpcFilter = route;
  route = "jpchax";
}

if (environment === "local") {
  JSON_DIR = "./json";
  ASSETS_DIR = "./assets";
} else {
  JSON_DIR = window.location.origin + "/DocumentLibrary/json";
  ASSETS_DIR = window.location.origin + "/ImageLibrary/journal-editorial-board"
}
const INFO_FILE = `${JSON_DIR}/journal-info.json`;
const METRICS_FILE = `${JSON_DIR}/journal_metrics.json`;
const RELATED_JOURNALS = `${JSON_DIR}/relatedJournals.json`;
const ROLE_SORT = `${JSON_DIR}/masthead-role-sort.json`;
const MASTHEAD_EXCLUSIONS = `${JSON_DIR}/masthead-exclusions.json`;
const JPC_FILTER = `${JSON_DIR}/jpc-filter-1712774473063.json`;
const AVATAR_IMG = `${ASSETS_DIR}/avatar.svg`;
let journalInfoJson;

const MASTHEAD_BASE =
  "https://raw.githubusercontent.com/DSCO-Support/JournalMastheads/refs/heads/main/mastheads/";
const BASE_URL = "https://pubs.acs.org";
// const CORS_PROXY = "https://corsproxy.io/?url=";

async function getMastheadJson(journalCoden, jpcFilter) {
  try {
    const response = await fetch(MASTHEAD_BASE + journalCoden + ".json");
    const dataJCI = await response.json();
    const roleSortOrder = await getRoleSort();
    const exclusions = await getExclusions(journalCoden);
    let roleList = await createRoles(dataJCI["data"], roleSortOrder);
    let sortedJCI = await sortByLastName(
      dataJCI["data"],
      jpcFilter,
      journalCoden
    );
    let display = await displayRoles(
      roleList,
      roleSortOrder,
      sortedJCI,
      journalCoden,
      exclusions[0],
      exclusions[1]
    );
  } catch (error) {
    console.error("Error fetching " + journalCoden + ".json : ", error);
  }
}

function updateEditorsHref() {
  const el = document.getElementById("viewEditorsMainSection");
  const el1 = document.getElementById("viewEditorsInSideBar");
  const el2 = document.getElementById("currentIssuePub");
  if (!el) return;

  const updatedRoute = String(route || "").replace(/^\/+|\/+$/g, "");
  if (!updatedRoute) return;

  if (el) {
    el.setAttribute("href", `/${updatedRoute}/editors`);
  }
  if (el1) {
    el1.setAttribute("href", `/${updatedRoute}/editors`);
  }
  if (el2) {
    el2.setAttribute("href", `/toc/${updatedRoute}/current#Mastheads`);
  }
}
updateEditorsHref();

// --- Fetch helper ---
async function fetchJSON(url) {
  const res = await fetch(url);
  if (!res.ok)
    throw new Error(`Failed to load ${url}: ${res.status} ${res.statusText}`);
  return res.json();
}

function getJournalInfo(infoJson, code) {
  const root = infoJson.journalInfo ?? infoJson;
  return root?.journal?.[code] ?? null;
}
function getJournalMetrics(metricsJson, code) {
  const root = metricsJson.journal_metrics ?? metricsJson;
  return root?.journal?.[code] ?? null;
}

function getEditorInfo(info) {
  return info?.editorInfo ?? info?.editor ?? null;
}

function formatPercent(x) {
  return typeof x === "number" ? `${Math.round(x * 100)}%` : "—";
}

function showOnly(sectionId) {
  document.querySelectorAll(".page").forEach((sec) => {
    sec.classList.toggle("active", sec.id === sectionId);
  });
}

function buildAffiliation(person) {
  const parts = [];

  const aff =
    person?.["Affiliation"] ||
    person?.["Institution"] ||
    person?.["Organization"] ||
    "";

  const country = person?.["Country"] || person?.["Location"] || "";

  if (aff) parts.push(aff);
  if (country) parts.push(country);

  return parts.filter(Boolean).join("<br>");
}

function updateEditorInfo(person, editorInfo, role) {
  const map = {
    "Editor-in-Chief": {
      mainNameId: "sc-editors__eic-value",
      sideContainerId: "editor-in-chief",
      sideNameId: "sideSectionEditorName",
      sideProfileImageId: "sc-editor__avatar__editorInChiefProfileIcon",
      sideInstitutionName: "chiefUnivName",
      sideCountryName: "chiefCountry",
      emailId: "chiefEmail",
    },
    "Deputy Editor": {
      mainNameId: "sc-editors__de-value",
      sideContainerId: "deputy-editor",
      sideNameId: "sideSectionDeputyName",
      sideProfileImageId: "deputyEditorProfileIcon",
      sideInstitutionName: "deputyUnivName",
      sideCountryName: "deputyCountry",
      emailId: "deputyEmail",
    },
  };

  const cfg = map[role];
  if (!cfg) return;

  const name =
    person?.["Display Name"] ||
    [person?.["First Name"], person?.["Last Name"]].filter(Boolean).join(" ") ||
    person?.["Name"] ||
    person?.name ||
    "";

  if (name) {
    setText(cfg.mainNameId, name || "—");
    setText(cfg.sideNameId, name || "—");
    setImage(editorInfo, name, cfg);
  }

  if (person) {
    setWebsiteLink(cfg.sideNameId, person);
    setText(cfg.sideInstitutionName, person["Institution Name"]);
    setText(cfg.sideCountryName, person["Country"]);
    setText(cfg.emailId, person["Email"]);
  }
}

function setWebsiteLink(id, person) {
  const el = document.getElementById(id);
  if (el instanceof HTMLAnchorElement && person.Website) {
    el.href = person.Website;
    el.target = "_blank";
  }
}

function setImage(editorInfo, name, cfg) {
  const imageEl = document.getElementById(cfg.sideProfileImageId);
  imageEl.src = BASE_URL + editorInfo[name].imgUrl;
  if (!editorInfo[name].imgUrl) {
    imageEl.onerror = null;
    imageEl.src = AVATAR_IMG;
  }
}

function adjustVisibility(hasEditorInChief, hasDeputyEditor) {
  const mainEICName = document.getElementById("sc-editors__eic-value");
  const mainDEName = document.getElementById("sc-editors__de-value");
  const sideEICName = document.getElementById("sideSectionEditorName");
  const sideDEName = document.getElementById("sideSectionDeputyName");

  if (mainEICName?.parentElement) {
    mainEICName.parentElement.style.display = hasEditorInChief ? "" : "none";
  }
  if (mainDEName?.parentElement) {
    mainDEName.parentElement.style.display = hasDeputyEditor ? "" : "none";
  }
  if (sideEICName?.closest("#sc-editor-foot__editorInChief-container")) {
    sideEICName.closest(
      "#sc-editor-foot__editorInChief-container"
    ).style.display = hasEditorInChief ? "" : "none";
  }
  if (sideDEName?.closest("#sideSectionDeputyEditorContainer")) {
    sideDEName.closest("#sideSectionDeputyEditorContainer").style.display =
      hasDeputyEditor ? "" : "none";
  }
}

async function loadMastheadAndRenderEditors(code, editorInfo) {
  try {
    const masthead = await fetchJSON(`${MASTHEAD_BASE}/${code}.json`);
    const rows = Array.isArray(masthead?.data) ? masthead.data : [];
    let hasEditorInChief = false;
    let hasDeputyEditor = false;

    rows.forEach((person) => {
      if (person?.["Masthead Category"] === "Editor-in-Chief") {
        hasEditorInChief = true;
        updateEditorInfo(person, editorInfo, "Editor-in-Chief");
      }
    });

    rows.forEach((person) => {
      if (person?.["Masthead Category"] === "Deputy Editor") {
        hasDeputyEditor = true;
        updateEditorInfo(person, editorInfo, "Deputy Editor");
      }
    });

    adjustVisibility(hasEditorInChief, hasDeputyEditor);
  } catch (err) {
    console.error("Error fetching masthead data:", err);
    const hasEICInfo = !!(
      editorInfo?.["Editor-in-Chief"] ??
      editorInfo?.eic ??
      null
    );
    const hasDEInfo = !!(
      editorInfo?.["Deputy Editor"] ??
      editorInfo?.deputy ??
      null
    );
    adjustVisibility(hasEICInfo, hasDEInfo);
  }
}

function findRelatedJournals(code, allJournalsArray) {
  return allJournalsArray.relatedJournals.find((journal) =>
    journal.coden.includes(code)
  );
}

async function renderJournalForCoden(code, indexes) {
  const { infoIndex, metricsIndex, allJournalsArray } = indexes;
  journalInfoJson = infoIndex;
  let relatedJournals = findRelatedJournals(code, allJournalsArray);
  const info = getJournalInfo(infoIndex, code);
  const metrics = getJournalMetrics(metricsIndex, code);

  //const codenData = await fetchJSON(`${JSON_DIR}/${code}.json`);

  setText("sc-header__title", metrics?.title ?? "—");
  setBlurbValue(metrics, info);

  const editorInfo = getEditorInfo(info);
  const fallbackEIC =
    editorInfo?.["Editor-in-Chief"]?.toString?.() ??
    (typeof editorInfo?.eic === "string" ? editorInfo.eic : "");
  const fallbackDeputy =
    editorInfo?.["Deputy Editor"]?.toString?.() ??
    (typeof editorInfo?.deputy === "string" ? editorInfo.deputy : "");

  setText("sc-editors__eic-value", fallbackEIC || "");
  setText("sc-editors__de-value", fallbackDeputy || "");

  setText("sc-metrics__impact-value", metrics?.impact2yr ?? "—");
  setText(
    "sc-metrics__cites-value",
    formatNumber(metrics?.citations) ? formatNumber(metrics?.citations) : "NaN"
  );
  setText(
    "sc-metrics__citescore-value",
    metrics?.citescore ? metrics?.citescore : "NaN"
  );
  setText(
    "sc-metrics__value--cites",
    formatNumber(metrics?.citations) ?? "NaN"
  );
  setText(
    "sc-metrics__value--two-if",
    metrics?.impact2yr ? metrics?.impact2yr : "NaN"
  );
  setText(
    "sc-metrics__value--five-if",
    metrics?.impact5yr ? metrics?.impact5yr : "NaN"
  );
  setText(
    "sc-metrics__value--citescore",
    metrics?.citescore ? metrics?.citescore : "NaN"
  );
  setText(
    "sc-metrics__value--days-asap",
    metrics?.AcceptToASAP ? metrics?.AcceptToASAP : "NaN"
  );
  setText(
    "sc-metrics__value--total-cites",
    formatNumber(metrics?.citations) ?? "NaN"
  );
  setText(
    "sc-metrics__value--days-first",
    metrics?.SubToFDwPR ? metrics?.SubToFDwPR : "NaN"
  );
  setText(
    "sc-metrics__value--days-accept",
    metrics?.SubToAccept ? metrics?.SubToAccept : "NaN"
  );
  setText("printEditionISSN", info?.issn ? info.issn : "");
  setText("webEditionISSN", info?.eissn ? info?.eissn : "");

  if (relatedJournals) {
    setRelatedJournalOptions(relatedJournals, code);
  } else {
    document.getElementById("sc-reljournals").style.display = "none";
  }

  //document.querySelectorAll(".providedYear")
  document.querySelectorAll(".sc-metrics__year").forEach((i) => {
    i.textContent = metricsIndex.journal_metrics.year;
  });
  //setIndexedAndAbstractedData(info);

  await loadMastheadAndRenderEditors(code, editorInfo);
}

function setBlurbValue(metrics, info) {
  let tailValue = info.blurb.slice(metrics.title.length);
  let emElement = document.createElement("em");
  emElement.textContent = info.title;
  let el = document.getElementById("sc-mdw__blurb-value");
  el.textContent = "";
  const tailNode = document.createTextNode(tailValue);
  el.append(emElement, tailNode);
}

// function setIndexedAndAbstractedData(info) {
//   const indexedList = document.getElementById("indexedList");
//   indexedList.innerHTML = "";
//   info.indexAbstract.forEach((abstract) => {
//     const listItem = document.createElement("li");
//     listItem.textContent = abstract;
//     indexedList.appendChild(listItem);
//   });
// }

function setRelatedJournalOptions(relatedJournals, code) {
  const select = document.getElementById("sc-select__menu");
  relatedJournals.journ_name.forEach((item) => {
    if (item.includes(code)) {
      return;
    }
    let optionValue = item.split("|")[0].toString().trim();
    let coden = item.split("|")[1].toString().trim();
    const listElement = document.createElement("li");
    const anchorElement = document.createElement("a");
    listElement.role = "option";
    anchorElement.dataset.value = optionValue;
    anchorElement.dataset.coden = coden;
    anchorElement.textContent = optionValue;
    anchorElement.href = "/" + coden;
    listElement.append(anchorElement);
    select.appendChild(listElement);
  });
}

function fetchImages(editorInfo) {
  fetch(baseURL + editorInfo[Object.keys(editorInfo)[0]].imgUrl)
    .then((res) => {})
    .catch((err) => {});
}

function setText(id, value) {
  const el = document.getElementById(id);
  if (el) el.textContent = value;
}

function setPreJSON(id, obj) {
  const el = document.getElementById(id);
  if (el) el.textContent = JSON.stringify(obj, null, 2);
}

let indexesCache = null;

async function loadIndexesOnce() {
  if (indexesCache) return indexesCache;
  const [infoIndex, metricsIndex, allJournalsArray] = await Promise.all([
    fetchJSON(INFO_FILE),
    fetchJSON(METRICS_FILE),
    fetchJSON(RELATED_JOURNALS),
  ]);
  indexesCache = { infoIndex, metricsIndex, allJournalsArray };
  return indexesCache;
}

async function render(routeName) {
  const indexes = await loadIndexesOnce();
  console.log(indexes);
  const knownCodens = new Set([
    ...Object.keys(
      (indexes.infoIndex.journalInfo ?? indexes.infoIndex)?.journal ?? {}
    ),
    ...Object.keys(
      (indexes.metricsIndex.journal_metrics ?? indexes.metricsIndex)?.journal ??
        {}
    ),
  ]);

  if (knownCodens.has(routeName)) {
    showOnly("journal");
    try {
      await renderJournalForCoden(routeName, indexes);
    } catch (err) {
      console.error(err);
    }
    return;
  }else{
    
  }
  console.warn(`Unknown route/coden: "${routeName}"`);
  document.getElementById("main").innerHTML = "<h1>404 Not Found</h1>";
}

function openInNewTab(event, url) {
  event.preventDefault();
  window.open(url + route, "_blank");
}

function redirectToCoden(event) {
  let coden = event.target.options[event.target.selectedIndex].dataset.coden;
  if (coden) {
    window.location.href = "/" + coden;
  }
}

document.addEventListener("DOMContentLoaded", () => {
  const customSelects = document.querySelectorAll(".sc-custom-select");

  customSelects.forEach((selectWrapper) => {
    const selectBtn = selectWrapper.querySelector(".sc-related-journals");
    let arrowEl = document.getElementById("sc-select__arrow-img");
    // Toggle dropdown visibility on button click
    selectBtn.addEventListener("click", () => {
      selectWrapper.classList.toggle("active");
      if (selectWrapper.classList.contains("active")) {
        //arrowEl.src = "./assets/UpArrow.svg";
        arrowEl.classList.remove("icon-general_arrow-down");
        arrowEl.classList.add(" icon-arrow-right");
      } else {
        //arrowEl.src = "./assets/DownArrow.svg";
        arrowEl.classList.remove("icon-arrow-right");
        arrowEl.classList.add("icon-general_arrow-down");
      }
      const expanded =
        selectBtn.getAttribute("aria-expanded") === "true" || false;
      selectBtn.setAttribute("aria-expanded", !expanded);
    });

    window.addEventListener("click", (e) => {
      if (!selectWrapper.contains(e.target)) {
        selectWrapper.classList.remove("active");
        arrowEl.classList.remove("icon-arrow-right");
        arrowEl.classList.add(" icon-general_arrow-down");
        //arrowEl.src = "./assets/DownArrow.svg";
        selectBtn.setAttribute("aria-expanded", "false");
      }
    });
  });
});

function relatedJournalValueUpdate(event) {
  const button = document.querySelector(".sc-related-journals");
  button.textContent = event.target.textContent;
  button.setAttribute("aria-expanded", "false");
}

function formatNumber(number) {
  const formattedNumber = parseInt(number).toLocaleString("en-US");
  return formattedNumber;
}

async function getRoleSort() {
  try {
    const response = await fetch(ROLE_SORT);
    const dataRoleSort = await response.json();
    let roleSortOrder = [];
    dataRoleSort.sort(function (a, b) {
      let x = a["Role Sort Number"],
        y = b["Role Sort Number"];
      return x < y ? -1 : x > y ? 1 : 0;
    });
    return dataRoleSort;
  } catch (error) {
    console.error("Error fetching masthead-role-sort.json :", error);
  }
}

async function getExclusions(journalCoden) {
  try {
    const response = await fetch(MASTHEAD_EXCLUSIONS);
    const dataExclusions = await response.json();
    let excludeCurrentIssue = false;
    let eabOnly = false;
    let exclusionsArray = [];

    if (dataExclusions[journalCoden]) {
      if (dataExclusions[journalCoden]["currentIssue"] === true) {
        excludeCurrentIssue = true;
        // console.log("excludeCurrentIssue: " + excludeCurrentIssue);
      }
      if (dataExclusions[journalCoden]["allExceptEAB"] === true) {
        eabOnly = true;
        // console.log("eabOnly: " + eabOnly);
      }
    }
    exclusionsArray = [excludeCurrentIssue, eabOnly];
    return exclusionsArray;
  } catch (error) {
    console.error("Error fetching masthead-exclusions.json :", error);
  }
}

async function getJPCfilter() {
  try {
    const response = await fetch(JPC_FILTER);
    const dataJPCfilter = await response.json();
    return dataJPCfilter;
  } catch (error) {
    console.error("Error fetching jpc-filter.json :", error);
  }
}

async function createRoles(arrayEditors, arraySortOrder) {
  let listOfRoles = [];
  let roleListSorted = [];

  // create listOfRoles array of available editor roles in current journal
  for (i = 0; i < arrayEditors.length; i++) {
    if (arrayEditors[i]["Masthead Category"] === "Editor Emerita") {
      arrayEditors[i]["Masthead Category"] = "Editor Emeritus";
    }
    if (listOfRoles.indexOf(arrayEditors[i]["Masthead Category"]) === -1) {
      listOfRoles.push(arrayEditors[i]["Masthead Category"]);
    }
  }

  // sort listOfRoles according to defined masthead role sort order display
  arraySortOrder.forEach(function (sortRole) {
    let found = false;
    listOfRoles = listOfRoles.filter(function (currentRole) {
      if (!found && currentRole == sortRole["Masthead Category"]) {
        roleListSorted.push(currentRole);
        found = true;
        return false;
      } else return true;
    });
  });

  return roleListSorted;
}

async function sortByLastName(arrayEditors, jpcFilter, journalCoden) {
  // arrayEditors.sort(function(a,b){
  //     // return a["Last Name"].toLowerCase().localeCompare(b["Last Name"].toLowerCase());
  //     return a["Last Name"].localeCompare(b["Last Name"], undefined, {sensitivity: 'base'});
  // });
  let sortableEditors = [];
  let unsortableEditors = [];
  for (i = 0; i < arrayEditors.length; i++) {
    if (
      arrayEditors[i]["Journal Name"] ===
        "The Journal of the American Society for Mass Spectrometry" &&
      arrayEditors[i]["Masthead Category"] === "Board of Directors"
    ) {
      unsortableEditors.push(arrayEditors[i]);
    } else {
      // filter JPC deputy editors
      if (jpcFilter != "") {
        if(!dataJPC){
        dataJPC = await getJPCfilter();
        }
        if (dataJPC[jpcFilter]) {
          console.log(jpcFilter + " jpcFilter exists");
          if (
            arrayEditors[i]["Masthead Category"] === "Deputy Editor" &&
            arrayEditors[i]["First Name"] !=
              dataJPC[jpcFilter]["Deputy Editor"]["First Name"] &&
            arrayEditors[i]["Last Name"] !=
              dataJPC[jpcFilter]["Deputy Editor"]["Last Name"]
          ) {
            // console.log(arrayEditors[i]["First Name"] + " " + arrayEditors[i]["Last Name"] + " " + i + " filtered");
          } else {
            sortableEditors.push(arrayEditors[i]);
          }
        } else {
          if (arrayEditors[i]["Masthead Category"] != "Deputy Editor") {
            sortableEditors.push(arrayEditors[i]);
          }
        }
      } else {
        sortableEditors.push(arrayEditors[i]);
      }
    }
  }

  const sortedNames = sortableEditors.sort((a, b) => {
    const result = a["Last Name"].localeCompare(b["Last Name"]);
    return result !== 0
      ? result
      : a["First Name"].localeCompare(b["First Name"]);
  });

  let sortedArray = sortedNames;

  // append jamsef board of directors
  if (journalCoden === "jamsef") {
    let jamsefBOD = await getJAMSEFbod();
    if (jamsefBOD === null) {
      sortedArray = $.merge($.merge([], sortedNames), unsortableEditors);
    } else {
      // console.log(jamsefBOD["data"]);
      sortedArray = sortedArray.concat(jamsefBOD["data"]);
      // console.log(sortedArray);
    }
  }

  return sortedArray;
}

// display
async function displayRoles(
  roles,
  roleSort,
  editorsList,
  coden,
  excludeCurrentIssue,
  eabOnly
) {
  let currentIssue = false;
  let showDisclaimer = false;
  // let disclaimerArray = ["National Institutes of Health"];

  let isDeputyPresent = false;
  if (roles[1] === "Deputy Editor") {
    isDeputyPresent = true;
  }

  const disclaimerLink = document.createElement("a");
  disclaimerLink.className = "disclaimer-link";
  disclaimerLink.href = "#disclaimer";
  disclaimerLink.textContent = "*";

  // Create <p> element
  const disclaimerMessage = document.createElement("p");
  disclaimerMessage.id = "disclaimer";
  disclaimerMessage.className = "disclaimer-message";
  disclaimerMessage.textContent =
    "* This member of the editorial team is serving in their personal capacity";

  // Create <div> container
  const disclaimerContainer = document.createElement("div");
  disclaimerContainer.className = "disclaimer mt-5";

  // Append <p> to <div>
  //disclaimerContainer.appendChild(disclaimerMessage);

  // If you want to append the link and container to the DOM (e.g., body or a specific element)
  //document.body.appendChild(disclaimerLink);
  //document.body.appendChild(disclaimerContainer);

  for (i = 0; i < roles.length; i++) {
    let displayRoleContainer,
      displayRole,
      editorDisplayContainer = "";
    let editorsInRole = [];
    let editorCount = 0;
    let roleSortNum = 0;
    let currentRoleProps;
    let currentRoleMastheadDisplay;

    currentRoleProps = roleSort.find((obj) => {
      return obj["Masthead Category"] === roles[i];
    });
    roleSortNum = parseInt(currentRoleProps["Role Sort Number"]);
    currentRoleMastheadDisplay = currentRoleProps["Display Category"];

    // add link to current issue masthead

    if (
      eabOnly === false &&
      roleSortNum > 110 &&
      roleSortNum < 510 &&
      currentIssue === false
    ) {
      if (excludeCurrentIssue === false) {
        let currentIssueContainer = document.getElementById(
          "currentIssueContainer"
        );
        currentIssueContainer.style.display = "block";
      }
      currentIssue = true;
    }

    displayRoleContainer = document.createElement("div");
    displayRoleContainer.className = "role-container";

    displayRole = document.createElement("h2");
    displayRole.className = "role";
    displayRole.textContent = currentRoleMastheadDisplay;

    editorDisplayContainer = document.createElement("div");
    if (isDeputyPresent && (i === 0 || i === 1)) {
      editorDisplayContainer.className = "editor-information-container";
    } else if (i === 0) {
      editorDisplayContainer.className = "editor-information-container";
    } else {
      editorDisplayContainer.className = "editor-info-container";
    }

    // inside role, loop through to find available editors
    for (editorInfo = 0; editorInfo < editorsList.length; editorInfo++) {
      if (editorsList[editorInfo]["Masthead Category"] === roles[i]) {
        editorCount++;
        editorsInRole.push(editorsList[editorInfo]);
      }
    }

    // check if role needs to be plural
    if (editorCount > 1) {
      if (roleSortNum != 510 && roleSortNum != 511 && roleSortNum != 520) {
        // ignore 'Senior Advisory Board', 'Senior Editorial Advisory Board', 'Editorial Advisory Board'
        if (displayRole.textContent.indexOf("Editor") > -1) {
          displayRole.textContent = displayRole.textContent.replace(
            "Editor",
            "Editors"
          );
        } else if (displayRole.textContent.indexOf("Ambassador") > -1) {
          displayRole.textContent = displayRole.textContent.replace(
            "Ambassador",
            "Ambassadors"
          );
        }
      }
    } else {
      // single item display using css column displays weird in firefox
      editorDisplayContainer.classList.add("single-column");
    }

    // only display sections with editors
    if (editorCount > 0) {
      // sort list of editor objects by last name within role
      editorsInRole.sort(function (a, b) {
        return a["Last Name"] - b["Last Name"];
      });

      for (editors = 0; editors < editorsInRole.length; editors++) {
        let editorDisplay,
          editorName,
          editorInstitution,
          editorCountry,
          editorEmail = "";

        // replace single quote in email and website
        if (editorsInRole[editors]["Email"]) {
          if (editorsInRole[editors]["Email"].includes("'") === true) {
            editorsInRole[editors]["Email"] = editorsInRole[editors][
              "Email"
            ].replace("'", "&apos;");
          }
        }
        if (editorsInRole[editors]["Website"]) {
          if (editorsInRole[editors]["Website"].includes("'") === true) {
            editorsInRole[editors]["Website"] = editorsInRole[editors][
              "Website"
            ].replace("'", "&apos;");
          }
        }

        // display specific information for EIC
        if (eabOnly === false && roleSortNum >= 100 && roleSortNum <= 205) {
          let editorFullName =
            editorsInRole[editors]["First Name"] +
            " " +
            editorsInRole[editors]["Last Name"];
          if (
            editorsInRole[editors]["Masthead Category"] === "Editor-in-Chief" ||
            editorsInRole[editors]["Masthead Category"] === "Deputy Editor"
          ) {
            if(journalInfoJson){
            editorImageContainer = document.createElement("div");
            editorImage = document.createElement("img");
            editorImage.src =
              BASE_URL +
              journalInfoJson.journalInfo.journal[coden].editorInfo[
                editorFullName
              ].imgUrl;
            editorImage.classList.add("sc-editor__avatar");
            editorImageContainer.appendChild(editorImage);
            editorDisplayContainer.appendChild(editorImageContainer);
            }
          }

          editorDisplay = document.createElement("div");
          editorDisplay.className = "editor-info";

          editorName = document.createElement("div");
          editorName.className = "editor-name";
          editorName.textContent = editorFullName;

          if (
            editorsInRole[editors]["Website"] &&
            editorsInRole[editors]["Website"] != "n/a"
          ) {
            if (
              editorsInRole[editors]["Website"].indexOf("https://") === -1 &&
              editorsInRole[editors]["Website"].indexOf("http://") === -1
            ) {
              editorsInRole[editors]["Website"] =
                "http://" + editorsInRole[editors]["Website"];
            }
            let editorNameLinked = document.createElement("a");
            editorNameLinked.href = editorsInRole[editors]["Website"];
            editorNameLinked.textContent =
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"];
            editorNameLinked.title =
              "Visit " +
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"] +
              "'s website";
            editorName.innerHTML = "";
            editorName.appendChild(editorNameLinked);
          }

          editorInstitution = document.createElement("div");
          editorInstitution.className = "editor-institution";
          editorInstitution.textContent =
            editorsInRole[editors]["Institution Name"];

          if (editorsInRole[editors]["Masthead Disclaimer"] === true) {
            showDisclaimer = true;
            editorName.appendChild(disclaimerLink);
          }

          editorCountry = document.createElement("div");
          editorCountry.className = "editor-country";
          editorCountry.textContent = editorsInRole[editors]["Country"];

          if (editorsInRole[editors]["Email"]) {
            editorEmail = document.createElement("div");
            editorEmail.className = "editor-email";
            editorEmail.innerHTML =
              "E-mail: <a href='mailto:" +
              editorsInRole[editors]["Email"] +
              "' title='E-mail " +
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"] +
              "'>" +
              editorsInRole[editors]["Email"] +
              "</a>";
          }

          editorDisplay.appendChild(editorName);
          editorDisplay.appendChild(editorInstitution);
          editorDisplay.appendChild(editorCountry);
          if (editorEmail) editorDisplay.appendChild(editorEmail);
        }
        // display specific information for Editor Emeritus/as
        else if (
          eabOnly === false &&
          (roleSortNum === 120 ||
            roleSortNum === 121 ||
            roleSortNum === 231 ||
            roleSortNum === 232)
        ) {
          editorDisplay = document.createElement("div");
          editorDisplay.className = "editor-info";

          editorName = document.createElement("div");
          editorName.className = "editor-name";
          editorName.textContent =
            editorsInRole[editors]["First Name"] +
            " " +
            editorsInRole[editors]["Last Name"];

          if (
            editorsInRole[editors]["Website"] &&
            editorsInRole[editors]["Website"] != "n/a"
          ) {
            if (
              editorsInRole[editors]["Website"].indexOf("https://") === -1 &&
              editorsInRole[editors]["Website"].indexOf("http://") === -1
            ) {
              editorsInRole[editors]["Website"] =
                "http://" + editorsInRole[editors]["Website"];
            }
            let editorNameLinked = document.createElement("a");
            editorNameLinked.href = editorsInRole[editors]["Website"];
            editorNameLinked.textContent =
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"];
            editorNameLinked.title =
              "Visit " +
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"] +
              "'s website";
            editorName.innerHTML = "";
            editorName.appendChild(editorNameLinked);
          }

          editorInstitution = document.createElement("div");
          editorInstitution.className = "editor-institution";
          editorInstitution.textContent =
            editorsInRole[editors]["Institution Name"];

          if (editorsInRole[editors]["Masthead Disclaimer"] === true) {
            showDisclaimer = true;
            editorName.appendChild(disclaimerLink);
          }

          editorCountry = document.createElement("div");
          editorCountry.className = "editor-country";
          editorCountry.textContent = editorsInRole[editors]["Country"];

          editorDisplay.appendChild(editorName);
          editorDisplay.appendChild(editorInstitution);
          editorDisplay.appendChild(editorCountry);
        }
        // display specific information for Managing Editor
        else if (
          eabOnly === false &&
          roleSortNum >= 320 &&
          roleSortNum <= 410
        ) {
          editorDisplay = document.createElement("div");
          editorDisplay.className = "editor-info";

          if (
            editorsInRole[editors]["First Name"] &&
            editorsInRole[editors]["Last Name"]
          ) {
            editorName = document.createElement("div");
            editorName.className = "editor-name";
            editorName.textContent =
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"];

            if (
              editorsInRole[editors]["Website"] &&
              editorsInRole[editors]["Website"] != "n/a"
            ) {
              if (
                editorsInRole[editors]["Website"].indexOf("https://") === -1 &&
                editorsInRole[editors]["Website"].indexOf("http://") === -1
              ) {
                editorsInRole[editors]["Website"] =
                  "http://" + editorsInRole[editors]["Website"];
              }
              let editorNameLinked = document.createElement("a");
              editorNameLinked.href = editorsInRole[editors]["Website"];
              editorNameLinked.textContent =
                editorsInRole[editors]["First Name"] +
                " " +
                editorsInRole[editors]["Last Name"];
              editorNameLinked.title =
                "Visit " +
                editorsInRole[editors]["First Name"] +
                " " +
                editorsInRole[editors]["Last Name"] +
                "'s website";
              editorName.innerHTML = "";
              editorName.appendChild(editorNameLinked);
            }

            if (editorsInRole[editors]["Email"]) {
              editorEmail = document.createElement("div");
              editorEmail.className = "editor-email";
              editorEmail.innerHTML =
                "E-mail: <a href='mailto:" +
                editorsInRole[editors]["Email"] +
                "' title='E-mail " +
                editorsInRole[editors]["First Name"] +
                " " +
                editorsInRole[editors]["Last Name"] +
                "'>" +
                editorsInRole[editors]["Email"] +
                "</a>";
            }
          } else {
            editorName = document.createElement("div");
            editorName.className = "editor-name";

            if (editorsInRole[editors]["Email"]) {
              editorEmail = document.createElement("div");
              editorEmail.className = "editor-email";
              editorEmail.innerHTML =
                "E-mail: <a href='mailto:" +
                editorsInRole[editors]["Email"] +
                "' title='E-mail " +
                currentRoleMastheadDisplay +
                "'>" +
                editorsInRole[editors]["Email"] +
                "</a>";
            }
          }

          editorInstitution = document.createElement("div");
          editorInstitution.className = "editor-institution";
          editorInstitution.textContent =
            editorsInRole[editors]["Institution Name"];

          if (editorsInRole[editors]["Masthead Disclaimer"] === true) {
            showDisclaimer = true;
            editorName.appendChild(disclaimerLink);
          }

          editorCountry = document.createElement("div");
          editorCountry.className = "editor-country";
          editorCountry.textContent = editorsInRole[editors]["Country"];

          editorDisplay.appendChild(editorName);
          editorDisplay.appendChild(editorInstitution);
          editorDisplay.appendChild(editorCountry);
          if (editorEmail) editorDisplay.appendChild(editorEmail);
        }
        // display specific information for Associate Editors
        else if (
          eabOnly === false &&
          roleSortNum >= 205 &&
          roleSortNum < 510 &&
          roleSortNum != 260 &&
          roleSortNum != 231 &&
          roleSortNum != 232
        ) {
          editorDisplay = document.createElement("div");
          editorDisplay.className = "editor-info";

          editorName = document.createElement("div");
          editorName.className = "editor-name";
          editorName.textContent =
            editorsInRole[editors]["First Name"] +
            " " +
            editorsInRole[editors]["Last Name"];

          if (
            editorsInRole[editors]["Website"] &&
            editorsInRole[editors]["Website"] != "n/a"
          ) {
            if (
              editorsInRole[editors]["Website"].indexOf("https://") === -1 &&
              editorsInRole[editors]["Website"].indexOf("http://") === -1
            ) {
              editorsInRole[editors]["Website"] =
                "http://" + editorsInRole[editors]["Website"];
            }
            let editorNameLinked = document.createElement("a");
            editorNameLinked.href = editorsInRole[editors]["Website"];
            editorNameLinked.textContent =
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"];
            editorNameLinked.title =
              "Visit " +
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"] +
              "'s website";
            editorName.innerHTML = "";
            editorName.appendChild(editorNameLinked);
          }

          editorInstitution = document.createElement("div");
          editorInstitution.className = "editor-institution";
          editorInstitution.textContent =
            editorsInRole[editors]["Institution Name"];

          if (editorsInRole[editors]["Masthead Disclaimer"] === true) {
            showDisclaimer = true;
            editorName.appendChild(disclaimerLink);
          }

          editorCountry = document.createElement("div");
          editorCountry.className = "editor-country";
          editorCountry.textContent = editorsInRole[editors]["Country"];

          if (editorsInRole[editors]["Email"]) {
            editorEmail = document.createElement("div");
            editorEmail.className = "editor-email";
            editorEmail.innerHTML =
              "E-mail: <a href='mailto:" +
              editorsInRole[editors]["Email"] +
              "' title='E-mail " +
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"] +
              "'>" +
              editorsInRole[editors]["Email"] +
              "</a>";
          }

          editorDisplay.appendChild(editorName);
          editorDisplay.appendChild(editorInstitution);
          editorDisplay.appendChild(editorCountry);
          if (editorEmail) editorDisplay.appendChild(editorEmail);
        }
        // display specific information for EAB
        else if (
          (roleSortNum >= 510 || roleSortNum === 260) &&
          roleSortNum != 580
        ) {
          editorDisplay = document.createElement("div");
          editorDisplay.className = "editor-info";

          editorName = document.createElement("div");
          editorName.className = "editor-name";
          editorName.textContent =
            editorsInRole[editors]["First Name"] +
            " " +
            editorsInRole[editors]["Last Name"];

          if (
            editorsInRole[editors]["Website"] &&
            editorsInRole[editors]["Website"] != "n/a"
          ) {
            if (
              editorsInRole[editors]["Website"].indexOf("https://") === -1 &&
              editorsInRole[editors]["Website"].indexOf("http://") === -1
            ) {
              editorsInRole[editors]["Website"] =
                "http://" + editorsInRole[editors]["Website"];
            }
            let editorNameLinked = document.createElement("a");
            editorNameLinked.href = editorsInRole[editors]["Website"];
            editorNameLinked.textContent =
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"];
            editorNameLinked.title =
              "Visit " +
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"] +
              "'s website";
            editorName.innerHTML = "";
            editorName.appendChild(editorNameLinked);
          }

          editorInstitution = document.createElement("div");
          editorInstitution.className = "editor-institution";
          editorInstitution.textContent =
            editorsInRole[editors]["Institution Name"];

          if (editorsInRole[editors]["Masthead Disclaimer"] === true) {
            showDisclaimer = true;
            editorName.appendChild(disclaimerLink);
          }

          editorCountry = document.createElement("div");
          editorCountry.className = "editor-country";
          editorCountry.textContent = editorsInRole[editors]["Country"];

          editorDisplay.appendChild(editorName);
          editorDisplay.appendChild(editorInstitution);
          editorDisplay.appendChild(editorCountry);
        }
        // display specific information for Board of Directors
        else if (roleSortNum === 580) {
          editorDisplay = document.createElement("div");
          editorDisplay.className = "editor-info";

          let editorTitle = document.createElement("div");
          editorTitle.className = "editor-title";
          editorTitle.textContent = editorsInRole[editors]["Title"];

          editorName = document.createElement("div");
          editorName.className = "editor-name";
          editorName.textContent =
            editorsInRole[editors]["First Name"] +
            " " +
            editorsInRole[editors]["Last Name"];

          if (
            editorsInRole[editors]["Website"] &&
            editorsInRole[editors]["Website"] != "n/a"
          ) {
            if (
              editorsInRole[editors]["Website"].indexOf("https://") === -1 &&
              editorsInRole[editors]["Website"].indexOf("http://") === -1
            ) {
              editorsInRole[editors]["Website"] =
                "http://" + editorsInRole[editors]["Website"];
            }
            let editorNameLinked = document.createElement("a");
            editorNameLinked.href = editorsInRole[editors]["Website"];
            editorNameLinked.textContent =
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"];
            editorNameLinked.title =
              "Visit " +
              editorsInRole[editors]["First Name"] +
              " " +
              editorsInRole[editors]["Last Name"] +
              "'s website";
            editorName.innerHTML = "";
            editorName.appendChild(editorNameLinked);
          }

          editorInstitution = document.createElement("div");
          editorInstitution.className = "editor-institution";
          editorInstitution.textContent =
            editorsInRole[editors]["Institution Name"];

          if (editorsInRole[editors]["Masthead Disclaimer"] === true) {
            showDisclaimer = true;
            editorName.appendChild(disclaimerLink);
          }

          editorCountry = document.createElement("div");
          editorCountry.className = "editor-country";
          editorCountry.textContent = editorsInRole[editors]["Country"];

          editorDisplay.appendChild(editorTitle);
          editorDisplay.appendChild(editorName);
          editorDisplay.appendChild(editorInstitution);
          editorDisplay.appendChild(editorCountry);
        }
        // add name to editor name container
        editorDisplayContainer.appendChild(editorDisplay);
      }

      if (eabOnly === true) {
        if (roleSortNum >= 510 || roleSortNum === 260) {
          displayRoleContainer.appendChild(displayRole);
          displayRoleContainer.appendChild(editorDisplayContainer);
          appendToMasthead(displayRoleContainer, i, isDeputyPresent);
        }
      } else {
        displayRoleContainer.appendChild(displayRole);
        displayRoleContainer.appendChild(editorDisplayContainer);
        appendToMasthead(displayRoleContainer, i, isDeputyPresent);
      }

      if (showDisclaimer === true) {
        document
          .getElementById("masthead-display")
          .appendChild(disclaimerContainer);
      }
    }
  }
}

function appendToMasthead(displayRoleContainer, i, isDeputyPresent) {
  const mastheadDisplay = document.getElementById("masthead-display");

  if (i === 0) {
    const displayRoleParentContainer = document.createElement("div");
    displayRoleParentContainer.classList.add("sc-editor__people");
    displayRoleParentContainer.id = "chiefEditorAndDeputyEditor";
    displayRoleParentContainer.appendChild(displayRoleContainer);
    mastheadDisplay.appendChild(displayRoleParentContainer);
  } else if (i === 1 && isDeputyPresent) {
    const existingParentContainer = document.getElementById(
      "chiefEditorAndDeputyEditor"
    );
    existingParentContainer.appendChild(displayRoleContainer);
  } else {
    mastheadDisplay.appendChild(displayRoleContainer);
  }
}

render(route);
getMastheadJson(route, jpcFilter);

    </script>
</body>

</html>